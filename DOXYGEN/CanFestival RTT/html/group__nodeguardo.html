<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CanFestival RTT: Node-guarding Object</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="networkedit.ico"/></td>
  <td id="projectalign">
   <div id="projectname">CanFestival RTT<span id="projectnumber">&#160;V1.0.0</span>
   </div>
   <div id="projectbrief">CanFestival RTT</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__nodeguardo.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">函数</a>  </div>
  <div class="headertitle"><div class="title">Node-guarding Object<div class="ingroups"><a class="el" href="group__comobj.html">Communication Objects</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The node-guarding mechanism for a device is established through cyclically polling all slaves by the NMT master.  
<a href="#details">更多...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
函数</h2></td></tr>
<tr class="memitem:ga3f81fed5eb843c8baf131915f5826649"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nodeguardo.html#ga3f81fed5eb843c8baf131915f5826649">nodeguardInit</a> (<a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *d)</td></tr>
<tr class="memdesc:ga3f81fed5eb843c8baf131915f5826649"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start node guarding with respect to 0x100C and 0x100D in the object dictionary  <a href="group__nodeguardo.html#ga3f81fed5eb843c8baf131915f5826649">更多...</a><br /></td></tr>
<tr class="separator:ga3f81fed5eb843c8baf131915f5826649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac259820ffbdf98861fc0e75646fba119"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nodeguardo.html#gac259820ffbdf98861fc0e75646fba119">nodeguardStop</a> (<a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *d)</td></tr>
<tr class="memdesc:gac259820ffbdf98861fc0e75646fba119"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop producing node guarding messages  <a href="group__nodeguardo.html#gac259820ffbdf98861fc0e75646fba119">更多...</a><br /></td></tr>
<tr class="separator:gac259820ffbdf98861fc0e75646fba119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab3248945e06e8b05518beddf665f174d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nodeguardo.html#gab3248945e06e8b05518beddf665f174d">proceedNODE_GUARD</a> (<a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *d, <a class="el" href="struct_message.html">Message</a> *m)</td></tr>
<tr class="memdesc:gab3248945e06e8b05518beddf665f174d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is responsible to process a canopen-message which seams to be an NMT Error Control Messages.  <a href="group__nodeguardo.html#gab3248945e06e8b05518beddf665f174d">更多...</a><br /></td></tr>
<tr class="separator:gab3248945e06e8b05518beddf665f174d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58b22c95490ed51c5fd5608ac4f5d148"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nodeguardo.html#ga58b22c95490ed51c5fd5608ac4f5d148">GuardTimeAlarm</a> (<a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *d, <a class="el" href="applicfg_8h.html#a889a782714194ae2f780002d25d6e0be">UNS32</a> id)</td></tr>
<tr class="memdesc:ga58b22c95490ed51c5fd5608ac4f5d148"><td class="mdescLeft">&#160;</td><td class="mdescRight">The guardTime - Timer Callback.  <a href="group__nodeguardo.html#ga58b22c95490ed51c5fd5608ac4f5d148">更多...</a><br /></td></tr>
<tr class="separator:ga58b22c95490ed51c5fd5608ac4f5d148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ca299d2e686313a85093b8a381af80a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="applicfg_8h.html#a889a782714194ae2f780002d25d6e0be">UNS32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nodeguardo.html#ga6ca299d2e686313a85093b8a381af80a">OnNodeGuardUpdate</a> (<a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *d, const <a class="el" href="objdictdef_8h.html#acd05cef26afde599867f00ba1d48dc45">indextable</a> *unused_indextable, <a class="el" href="applicfg_8h.html#a539234687760592d01a8b0d3357bc00e">UNS8</a> unused_bSubindex)</td></tr>
<tr class="memdesc:ga6ca299d2e686313a85093b8a381af80a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is called, if index 0x100C or 0x100D is updated to restart the node-guarding service with the new parameters  <a href="group__nodeguardo.html#ga6ca299d2e686313a85093b8a381af80a">更多...</a><br /></td></tr>
<tr class="separator:ga6ca299d2e686313a85093b8a381af80a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<p >The node-guarding mechanism for a device is established through cyclically polling all slaves by the NMT master. </p>
<p >If one polled slave does not respond during a specified time (LifeTime), the local application will be informed about that event.<br  />
 It is also possible for the slaves to monitor the node-guarding requests coming from the master to determine, if the master operates in a right way</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">待办事项:</a></b></dt><dd>The implementation is very basic. The toggle bit of the nodes confirmation is not checked at the moment </dd></dl>
<h2 class="groupheader">函数说明</h2>
<a id="ga58b22c95490ed51c5fd5608ac4f5d148" name="ga58b22c95490ed51c5fd5608ac4f5d148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58b22c95490ed51c5fd5608ac4f5d148">&#9670;&#160;</a></span>GuardTimeAlarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GuardTimeAlarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="applicfg_8h.html#a889a782714194ae2f780002d25d6e0be">UNS32</a>&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="lifegrd_8c.html">C:/Users/Administrator/Desktop/STM32F4_RTT_v5.0/packages/CanFestival-latest/src/lifegrd.c</a>&gt;</code></p>

<p>The guardTime - Timer Callback. </p>
<p >This function is called every GuardTime (OD 0x100C) ms <br  />
 On every call, a NodeGuard-Request is sent to all nodes which have a node-state not equal to "Unknown" (according to NMTable). If the node has not responded within the lifetime, the nodeguardError function is called and the status of this node is set to "Disconnected"</p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Pointer on a CAN object data structure </td></tr>
    <tr><td class="paramname">id</td><td></td></tr>
  </table>
  </dd>
</dl>
<p >Send node guard request to all nodes except this node, if the node state is not "Unknown_state"</p>
<p >Check if the node has confirmed the guarding request within the LifeTime (GuardTime x LifeTimeFactor)</p>

<p class="definition">在文件 <a class="el" href="lifegrd_8c_source.html">lifegrd.c</a> 第 <a class="el" href="lifegrd_8c_source.html#l00210">210</a> 行定义.</p>

</div>
</div>
<a id="ga3f81fed5eb843c8baf131915f5826649" name="ga3f81fed5eb843c8baf131915f5826649"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3f81fed5eb843c8baf131915f5826649">&#9670;&#160;</a></span>nodeguardInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nodeguardInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="lifegrd_8h.html">C:/Users/Administrator/Desktop/STM32F4_RTT_v5.0/packages/CanFestival-latest/inc/lifegrd.h</a>&gt;</code></p>

<p>Start node guarding with respect to 0x100C and 0x100D in the object dictionary </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">*d</td><td>Pointer on a CAN object data structure </td></tr>
  </table>
  </dd>
</dl>
<p >Set initial value for the nodes</p>

<p class="definition">在文件 <a class="el" href="lifegrd_8c_source.html">lifegrd.c</a> 第 <a class="el" href="lifegrd_8c_source.html#l00317">317</a> 行定义.</p>

</div>
</div>
<a id="gac259820ffbdf98861fc0e75646fba119" name="gac259820ffbdf98861fc0e75646fba119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac259820ffbdf98861fc0e75646fba119">&#9670;&#160;</a></span>nodeguardStop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nodeguardStop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="lifegrd_8h.html">C:/Users/Administrator/Desktop/STM32F4_RTT_v5.0/packages/CanFestival-latest/inc/lifegrd.h</a>&gt;</code></p>

<p>Stop producing node guarding messages </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">*d</td><td>Pointer on a CAN object data structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">在文件 <a class="el" href="lifegrd_8c_source.html">lifegrd.c</a> 第 <a class="el" href="lifegrd_8c_source.html#l00353">353</a> 行定义.</p>

</div>
</div>
<a id="ga6ca299d2e686313a85093b8a381af80a" name="ga6ca299d2e686313a85093b8a381af80a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6ca299d2e686313a85093b8a381af80a">&#9670;&#160;</a></span>OnNodeGuardUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="applicfg_8h.html#a889a782714194ae2f780002d25d6e0be">UNS32</a> OnNodeGuardUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="objdictdef_8h.html#acd05cef26afde599867f00ba1d48dc45">indextable</a> *&#160;</td>
          <td class="paramname"><em>unused_indextable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="applicfg_8h.html#a539234687760592d01a8b0d3357bc00e">UNS8</a>&#160;</td>
          <td class="paramname"><em>unused_bSubindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="lifegrd_8c.html">C:/Users/Administrator/Desktop/STM32F4_RTT_v5.0/packages/CanFestival-latest/src/lifegrd.c</a>&gt;</code></p>

<p>This function is called, if index 0x100C or 0x100D is updated to restart the node-guarding service with the new parameters </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Pointer on a CAN object data structure </td></tr>
    <tr><td class="paramname">unused_indextable</td><td></td></tr>
    <tr><td class="paramname">unused_bSubindex</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">在文件 <a class="el" href="lifegrd_8c_source.html">lifegrd.c</a> 第 <a class="el" href="lifegrd_8c_source.html#l00263">263</a> 行定义.</p>

</div>
</div>
<a id="gab3248945e06e8b05518beddf665f174d" name="gab3248945e06e8b05518beddf665f174d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab3248945e06e8b05518beddf665f174d">&#9670;&#160;</a></span>proceedNODE_GUARD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void proceedNODE_GUARD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data_8h.html#ab5cf1318d7813273cd91a7af56f62142">CO_Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_message.html">Message</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="lifegrd_8h.html">C:/Users/Administrator/Desktop/STM32F4_RTT_v5.0/packages/CanFestival-latest/inc/lifegrd.h</a>&gt;</code></p>

<p>This function is responsible to process a canopen-message which seams to be an NMT Error Control Messages. </p>
<p >If a BootUp message is detected, it will return the nodeId of the Slave who booted up </p><dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">*d</td><td>Pointer on a CAN object data structure </td></tr>
    <tr><td class="paramname">*m</td><td>Pointer on the CAN-message which has to be analysed. </td></tr>
  </table>
  </dd>
</dl>
<p >Notice that only the master can have sent this node guarding request</p>
<p >Receiving a NMT NodeGuarding (request of the state by the master) Only answer to the NMT NodeGuarding request, the master is not checked (not implemented)</p>
<p >Record node response for node guarding service</p>

<p class="definition">在文件 <a class="el" href="lifegrd_8c_source.html">lifegrd.c</a> 第 <a class="el" href="lifegrd_8c_source.html#l00082">82</a> 行定义.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">制作者 <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
